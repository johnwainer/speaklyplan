
# üéì SpeaklyPlan - Plataforma Inteligente de Aprendizaje de Ingl√©s

![Next.js](https://img.shields.io/badge/Next.js-14.2.28-black)
![TypeScript](https://img.shields.io/badge/TypeScript-5.2.2-blue)
![Prisma](https://img.shields.io/badge/Prisma-6.7.0-2D3748)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15+-336791)
![License](https://img.shields.io/badge/license-MIT-green)

SpeaklyPlan es una plataforma moderna e inteligente para el aprendizaje de ingl√©s, que combina IA conversacional, gamificaci√≥n, pr√°cticas 1-on-1 y seguimiento personalizado del progreso.

---

## üìë Tabla de Contenidos

- [Caracter√≠sticas Principales](#-caracter√≠sticas-principales)
- [Tecnolog√≠as Utilizadas](#-tecnolog√≠as-utilizadas)
- [Requisitos Previos](#-requisitos-previos)
- [Instalaci√≥n y Configuraci√≥n](#-instalaci√≥n-y-configuraci√≥n)
- [Configuraci√≥n de Base de Datos](#-configuraci√≥n-de-base-de-datos)
- [Variables de Entorno](#-variables-de-entorno)
- [Comandos Disponibles](#-comandos-disponibles)
- [Despliegue](#-despliegue)
- [Estructura del Proyecto](#-estructura-del-proyecto)
- [Funcionalidades Detalladas](#-funcionalidades-detalladas)
- [Usuarios de Prueba](#-usuarios-de-prueba)
- [Soluci√≥n de Problemas](#-soluci√≥n-de-problemas)

---

## ‚ú® Caracter√≠sticas Principales

### ü§ñ **Tutor AI Conversacional**
- Conversaciones fluidas en tiempo real con IA
- Reconocimiento de voz y s√≠ntesis de habla
- An√°lisis inteligente de pronunciaci√≥n y gram√°tica
- Sugerencias contextuales personalizadas
- Historial completo de sesiones

### üìä **Dashboard Inteligente**
- Seguimiento detallado del progreso
- Gr√°ficos interactivos de aprendizaje
- Sistema de logros y niveles
- Estad√≠sticas semanales y mensuales
- Recomendaciones personalizadas

### üë• **Pr√°cticas 1-on-1**
- Sistema de invitaciones entre usuarios
- Programaci√≥n de sesiones de pr√°ctica
- Notificaciones en tiempo real
- Historial de pr√°cticas realizadas
- Gesti√≥n de conexiones

### üìö **Vocabulario Inteligente**
- Tarjetas de vocabulario interactivas
- Sistema de repetici√≥n espaciada
- Seguimiento de progreso por palabra
- Filtros y b√∫squeda avanzada
- Revisi√≥n personalizada

### üéØ **Sistema de Gamificaci√≥n**
- Puntos por cada actividad
- Niveles y rangos
- Logros desbloqueables
- Rachas diarias
- Tablas de clasificaci√≥n

### üë§ **Gesti√≥n de Perfil**
- Edici√≥n completa de datos personales
- Subida de foto de perfil (AWS S3)
- Configuraci√≥n de preferencias
- Gesti√≥n de contrase√±a
- Historial de actividad

---

## üõ†Ô∏è Tecnolog√≠as Utilizadas

### Frontend
- **Next.js 14.2.28** - Framework React con SSR
- **TypeScript 5.2.2** - Tipado est√°tico
- **Tailwind CSS 3.3.3** - Estilos utility-first
- **Radix UI** - Componentes accesibles
- **Framer Motion** - Animaciones
- **React Hook Form** - Gesti√≥n de formularios
- **Zustand** - Estado global

### Backend
- **Next.js API Routes** - Endpoints RESTful
- **NextAuth.js 4.24.11** - Autenticaci√≥n
- **Prisma 6.7.0** - ORM
- **PostgreSQL** - Base de datos relacional
- **bcryptjs** - Encriptaci√≥n de contrase√±as

### Servicios Externos
- **Abacus AI** - Motor de IA conversacional
- **AWS S3** - Almacenamiento de im√°genes
- **Web Speech API** - Reconocimiento y s√≠ntesis de voz

---

## üìã Requisitos Previos

Aseg√∫rate de tener instalado:

- **Node.js** 18.x o superior
- **npm** o **yarn** (recomendado)
- **PostgreSQL** 15 o superior
- **Git** para control de versiones

### Servicios Externos (Opcionales)
- Cuenta de **Abacus AI** (para el tutor IA)
- Cuenta de **AWS** (para almacenamiento de im√°genes)

---

## üöÄ Instalaci√≥n y Configuraci√≥n

### 1. Clonar el Repositorio

```bash
git clone https://github.com/johnwainer/speaklyplan.git
cd speaklyplan/nextjs_space
```

### 2. Instalar Dependencias

```bash
# Con yarn (recomendado)
yarn install

# Con npm
npm install
```

### 3. Configurar Variables de Entorno

Copia el archivo de ejemplo y configura tus variables:

```bash
cp .env.example .env
```

Edita el archivo `.env` con tus credenciales (ver secci√≥n [Variables de Entorno](#-variables-de-entorno)).

---

## üóÑÔ∏è Configuraci√≥n de Base de Datos

### 1. Crear Base de Datos PostgreSQL

```bash
# Conectarse a PostgreSQL
psql -U postgres

# Crear la base de datos
CREATE DATABASE speaklyplan;

# Crear usuario (opcional)
CREATE USER speaklyplan_user WITH PASSWORD 'tu_contrase√±a_segura';

# Dar permisos
GRANT ALL PRIVILEGES ON DATABASE speaklyplan TO speaklyplan_user;

# Salir
\q
```

### 2. Configurar DATABASE_URL

En tu archivo `.env`:

```env
DATABASE_URL="postgresql://speaklyplan_user:tu_contrase√±a_segura@localhost:5432/speaklyplan?connect_timeout=15"
```

### 3. Ejecutar Migraciones

```bash
# Generar el cliente de Prisma
yarn prisma generate

# Ejecutar migraciones
yarn prisma migrate deploy

# O crear una migraci√≥n nueva (desarrollo)
yarn prisma migrate dev
```

### 4. Cargar Datos de Prueba (Seed)

El proyecto incluye un script de seed que crea:
- 3 usuarios de prueba (1 admin + 2 usuarios normales)
- Vocabulario base
- Datos de progreso de ejemplo
- Sesiones de prueba

```bash
# Ejecutar seed
yarn prisma db seed
```

**Usuarios creados:**

| Email | Password | Rol |
|-------|----------|-----|
| admin@speaklyplan.com | admin123 | Admin |
| alejandrozapata.9806@gmail.com | 12345 | Usuario |
| user@speaklyplan.com | user123 | Usuario |

### 5. Verificar la Base de Datos

```bash
# Abrir Prisma Studio (GUI para ver datos)
yarn prisma studio
```

Esto abrir√° una interfaz web en `http://localhost:5555` donde puedes ver y editar datos.

---

## üîê Variables de Entorno

Configura las siguientes variables en tu archivo `.env`:

### Base de Datos (REQUERIDO)

```env
DATABASE_URL="postgresql://usuario:contrase√±a@localhost:5432/speaklyplan?connect_timeout=15"
```

### Autenticaci√≥n (REQUERIDO)

```env
# URL de tu aplicaci√≥n
NEXTAUTH_URL="http://localhost:3000"  # Desarrollo
# NEXTAUTH_URL="https://tudominio.com"  # Producci√≥n

# Secret para JWT (genera uno con: openssl rand -base64 32)
NEXTAUTH_SECRET="tu_secret_aleatorio_muy_largo_y_seguro"
```

Para generar un NEXTAUTH_SECRET seguro:

```bash
openssl rand -base64 32
```

### AWS S3 - Almacenamiento de Im√°genes (OPCIONAL)

```env
AWS_ACCESS_KEY_ID="tu_access_key_id"
AWS_SECRET_ACCESS_KEY="tu_secret_access_key"
AWS_REGION="us-east-1"
AWS_BUCKET_NAME="tu-bucket-name"
AWS_FOLDER_PREFIX="speaklyplan/"
```

**Nota:** Si no configuras AWS S3, la aplicaci√≥n funcionar√° pero sin subida de im√°genes de perfil.

### Abacus AI - Tutor IA (OPCIONAL)

```env
ABACUSAI_API_KEY="tu_api_key_de_abacus"
```

**Nota:** Si no configuras Abacus AI, el tutor IA no funcionar√° pero el resto de la app s√≠.

---

## üìú Comandos Disponibles

### Desarrollo

```bash
# Iniciar servidor de desarrollo
yarn dev

# La app estar√° disponible en http://localhost:3000
```

### Build y Producci√≥n

```bash
# Construir para producci√≥n
yarn build

# Iniciar servidor de producci√≥n
yarn start
```

### Base de Datos

```bash
# Generar cliente de Prisma
yarn prisma generate

# Ejecutar migraciones
yarn prisma migrate deploy

# Crear nueva migraci√≥n (desarrollo)
yarn prisma migrate dev --name nombre_de_migracion

# Cargar datos de prueba
yarn prisma db seed

# Abrir Prisma Studio
yarn prisma studio

# Resetear base de datos (¬°CUIDADO! Borra todos los datos)
yarn prisma migrate reset
```

### Scripts Personalizados

```bash
# Crear usuario administrador
yarn ts-node scripts/create-admin.ts

# Verificar usuario administrador
yarn ts-node scripts/check-admin.ts

# Hacer admin a un usuario existente
yarn ts-node scripts/make-admin.ts

# Exportar base de datos
yarn ts-node scripts/export-db.ts

# Importar base de datos
yarn ts-node scripts/import-db.ts
```

### Linting

```bash
# Verificar c√≥digo
yarn lint

# Corregir autom√°ticamente
yarn lint --fix
```

---

## üåê Despliegue

### Despliegue en Vercel (Recomendado)

1. **Push a GitHub** (ya hecho)

```bash
git push origin master
```

2. **Importar en Vercel**

- Ve a [vercel.com](https://vercel.com)
- Importa tu repositorio de GitHub
- Vercel detectar√° autom√°ticamente Next.js

3. **Configurar Variables de Entorno**

En Vercel, ve a Settings > Environment Variables y agrega:

```
DATABASE_URL=postgresql://...
NEXTAUTH_URL=https://tu-app.vercel.app
NEXTAUTH_SECRET=tu_secret
AWS_ACCESS_KEY_ID=...
AWS_SECRET_ACCESS_KEY=...
AWS_REGION=us-east-1
AWS_BUCKET_NAME=...
AWS_FOLDER_PREFIX=speaklyplan/
ABACUSAI_API_KEY=...
```

4. **Configurar Base de Datos**

Opciones:
- **Vercel Postgres** (recomendado)
- **Supabase** (gratis hasta cierto l√≠mite)
- **Railway** (f√°cil de configurar)
- **AWS RDS** (m√°s robusto)

5. **Ejecutar Migraciones**

Despu√©s del primer despliegue:

```bash
# Desde tu local, apuntando a producci√≥n
DATABASE_URL="tu_url_produccion" yarn prisma migrate deploy
DATABASE_URL="tu_url_produccion" yarn prisma db seed
```

6. **Deploy**

Vercel desplegar√° autom√°ticamente en cada push a master.

### Despliegue Manual (VPS/Servidor)

```bash
# 1. Clonar repositorio
git clone https://github.com/johnwainer/speaklyplan.git
cd speaklyplan/nextjs_space

# 2. Instalar dependencias
yarn install

# 3. Configurar .env
cp .env.example .env
nano .env  # Editar variables

# 4. Setup base de datos
yarn prisma generate
yarn prisma migrate deploy
yarn prisma db seed

# 5. Build
yarn build

# 6. Iniciar con PM2 (gestor de procesos)
pm2 start yarn --name "speaklyplan" -- start
pm2 save
pm2 startup

# 7. Configurar Nginx (proxy reverso)
# Ver archivo de configuraci√≥n m√°s abajo
```

**Nginx config (`/etc/nginx/sites-available/speaklyplan`):**

```nginx
server {
    listen 80;
    server_name tudominio.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

---

## üìÇ Estructura del Proyecto

```
speaklyplan/nextjs_space/
‚îú‚îÄ‚îÄ app/                          # App Router de Next.js
‚îÇ   ‚îú‚îÄ‚îÄ api/                      # API Routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/               # Endpoints de administraci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/                # Autenticaci√≥n (NextAuth)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ practice/            # Sistema de pr√°cticas 1-on-1
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile/             # Gesti√≥n de perfil
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tutor/               # Tutor IA
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vocabulary/          # Vocabulario
‚îÇ   ‚îú‚îÄ‚îÄ admin/                   # Panel de administraci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ auth/                    # P√°ginas de autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/               # Dashboard principal
‚îÇ   ‚îú‚îÄ‚îÄ guia/                    # Gu√≠a de uso
‚îÇ   ‚îú‚îÄ‚îÄ one-on-one/              # Pr√°cticas 1-on-1
‚îÇ   ‚îú‚îÄ‚îÄ perfil/                  # Perfil de usuario
‚îÇ   ‚îú‚îÄ‚îÄ practice/                # Sistema de pr√°cticas (legacy)
‚îÇ   ‚îú‚îÄ‚îÄ recursos/                # Recursos de aprendizaje
‚îÇ   ‚îú‚îÄ‚îÄ tutor/                   # Tutor IA
‚îÇ   ‚îú‚îÄ‚îÄ vocabulario/             # Vocabulario
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx               # Layout principal
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                 # P√°gina de inicio
‚îú‚îÄ‚îÄ components/                   # Componentes reutilizables
‚îÇ   ‚îú‚îÄ‚îÄ app-header.tsx           # Header unificado
‚îÇ   ‚îú‚îÄ‚îÄ practice/                # Componentes de pr√°cticas
‚îÇ   ‚îî‚îÄ‚îÄ ui/                      # Componentes UI base
‚îú‚îÄ‚îÄ hooks/                        # Custom React Hooks
‚îú‚îÄ‚îÄ lib/                          # Utilidades y configuraci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ db/                      # Funciones de base de datos
‚îÇ   ‚îú‚îÄ‚îÄ db.ts                    # Cliente de Prisma
‚îÇ   ‚îú‚îÄ‚îÄ types.ts                 # Tipos TypeScript
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts                 # Funciones auxiliares
‚îú‚îÄ‚îÄ prisma/                       # Configuraci√≥n de Prisma
‚îÇ   ‚îú‚îÄ‚îÄ migrations/              # Migraciones de BD
‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma            # Schema de base de datos
‚îú‚îÄ‚îÄ public/                       # Archivos est√°ticos
‚îú‚îÄ‚îÄ scripts/                      # Scripts de utilidad
‚îÇ   ‚îú‚îÄ‚îÄ create-admin.ts          # Crear usuario admin
‚îÇ   ‚îú‚îÄ‚îÄ seed.ts                  # Datos de prueba
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ .env                          # Variables de entorno (no commiteado)
‚îú‚îÄ‚îÄ .env.example                  # Ejemplo de variables
‚îú‚îÄ‚îÄ .gitignore                    # Archivos ignorados por git
‚îú‚îÄ‚îÄ next.config.js                # Configuraci√≥n de Next.js
‚îú‚îÄ‚îÄ package.json                  # Dependencias
‚îú‚îÄ‚îÄ tailwind.config.ts            # Configuraci√≥n de Tailwind
‚îú‚îÄ‚îÄ tsconfig.json                 # Configuraci√≥n de TypeScript
‚îî‚îÄ‚îÄ README.md                     # Este archivo
```

---

## üéØ Funcionalidades Detalladas

### 1. Sistema de Autenticaci√≥n

- Login con email y contrase√±a
- Registro de nuevos usuarios
- Recuperaci√≥n de contrase√±a
- Sesiones seguras con NextAuth.js
- Roles de usuario (Admin/Usuario)

### 2. Dashboard

- Progreso semanal y mensual
- Gr√°ficos de evoluci√≥n
- Logros y niveles
- Acceso r√°pido a funcionalidades
- Recomendaciones personalizadas

### 3. Tutor AI

- **Modo de conversaci√≥n fluida** (√∫nico modo)
- Reconocimiento de voz en tiempo real
- S√≠ntesis de voz natural
- An√°lisis de pronunciaci√≥n
- Sugerencias de gram√°tica
- Historial de conversaciones
- Sistema de gamificaci√≥n integrado

### 4. Pr√°cticas 1-on-1

- Enviar invitaciones a otros usuarios
- Aceptar/rechazar invitaciones
- Programar sesiones de pr√°ctica
- Notificaciones en tiempo real
- Historial de sesiones
- Gesti√≥n de conexiones

### 5. Vocabulario

- Tarjetas interactivas
- Sistema de repetici√≥n espaciada
- Filtros por nivel y categor√≠a
- B√∫squeda avanzada
- Seguimiento de progreso por palabra

### 6. Perfil

- Edici√≥n de datos personales
- Subida de foto de perfil
- Cambio de contrase√±a
- Configuraci√≥n de preferencias
- Historial de actividad

### 7. Panel de Administraci√≥n

- Gesti√≥n de usuarios
- Estad√≠sticas globales
- Exportaci√≥n de datos
- Creaci√≥n de usuarios
- Asignaci√≥n de roles

---

## üë• Usuarios de Prueba

Despu√©s de ejecutar el seed (`yarn prisma db seed`), tendr√°s estos usuarios:

### Usuario Administrador

```
Email: admin@speaklyplan.com
Password: admin123
Rol: Admin
```

Acceso completo al panel de administraci√≥n en `/admin`

### Usuario de Prueba 1

```
Email: alejandrozapata.9806@gmail.com
Password: 12345
Rol: Usuario
```

Usuario con datos de progreso de ejemplo.

### Usuario de Prueba 2

```
Email: user@speaklyplan.com
Password: user123
Rol: Usuario
```

Usuario b√°sico para pruebas.

---

## üîß Soluci√≥n de Problemas

### Error de conexi√≥n a base de datos

**Problema:** `Error: P1001: Can't reach database server`

**Soluci√≥n:**
1. Verifica que PostgreSQL est√© corriendo: `sudo service postgresql status`
2. Verifica la URL de conexi√≥n en `.env`
3. Aseg√∫rate de que el usuario tenga permisos

### Error de migraciones

**Problema:** `Prisma Migrate couldn't find the migrations`

**Soluci√≥n:**
```bash
# Resetear y volver a migrar
yarn prisma migrate reset
yarn prisma migrate deploy
yarn prisma db seed
```

### Error de tipos TypeScript

**Problema:** `Cannot find module '@/lib/...'`

**Soluci√≥n:**
```bash
# Regenerar cliente de Prisma
yarn prisma generate

# Reiniciar TypeScript server en tu editor
```

### Error de autenticaci√≥n

**Problema:** `NextAuth: NEXTAUTH_SECRET is not defined`

**Soluci√≥n:**
1. Genera un secret: `openssl rand -base64 32`
2. Agr√©galo a `.env`: `NEXTAUTH_SECRET="tu_secret"`
3. Reinicia el servidor

### Puerto 3000 en uso

**Problema:** `Port 3000 is already in use`

**Soluci√≥n:**
```bash
# Matar el proceso
lsof -ti:3000 | xargs kill -9

# O usar otro puerto
PORT=3001 yarn dev
```

### Im√°genes de perfil no se suben

**Problema:** Las im√°genes no se guardan

**Soluci√≥n:**
1. Verifica las credenciales de AWS en `.env`
2. Aseg√∫rate de que el bucket existe y tiene permisos
3. Verifica la pol√≠tica CORS del bucket

### Tutor IA no responde

**Problema:** El tutor no genera respuestas

**Soluci√≥n:**
1. Verifica que `ABACUSAI_API_KEY` est√© configurado en `.env`
2. Verifica que la API key sea v√°lida
3. Revisa los logs de la consola del navegador

---

## üìù Scripts de Utilidad

### Crear Usuario Administrador Manualmente

```bash
yarn ts-node scripts/create-admin.ts
```

Te pedir√°:
- Email
- Password
- Nombre completo

### Verificar Estado de Administrador

```bash
yarn ts-node scripts/check-admin.ts
```

### Convertir Usuario en Admin

```bash
yarn ts-node scripts/make-admin.ts
```

Requiere el email del usuario.

### Exportar Datos

```bash
yarn ts-node scripts/export-db.ts
```

Genera `database_export.json` con todos los datos.

### Importar Datos

```bash
yarn ts-node scripts/import-db.ts
```

Importa desde `database_export.json`.

---

## ü§ù Contribuir

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

---

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo `LICENSE` para m√°s detalles.

---

## üìû Soporte

Si tienes problemas o preguntas:

- üìß Email: johnwainer@gmail.com
- üêõ Issues: [GitHub Issues](https://github.com/johnwainer/speaklyplan/issues)
- üìñ Docs: Ver archivos `.md` en la ra√≠z del proyecto

---

## üéâ Agradecimientos

- [Next.js](https://nextjs.org/) - Framework principal
- [Prisma](https://www.prisma.io/) - ORM
- [NextAuth.js](https://next-auth.js.org/) - Autenticaci√≥n
- [Tailwind CSS](https://tailwindcss.com/) - Estilos
- [Radix UI](https://www.radix-ui.com/) - Componentes
- [Abacus AI](https://abacus.ai/) - Motor de IA

---

## üöÄ Roadmap

### Pr√≥ximas Funcionalidades
- [ ] Integraci√≥n con Google Calendar para pr√°cticas
- [ ] App m√≥vil nativa (React Native)
- [ ] Sistema de mensajer√≠a en tiempo real
- [ ] Certificados de finalizaci√≥n
- [ ] Marketplace de recursos
- [ ] Integraci√≥n con m√°s servicios de IA
- [ ] Modo offline
- [ ] Tests automatizados
- [ ] CI/CD con GitHub Actions

---

**Hecho con ‚ù§Ô∏è por el equipo de SpeaklyPlan**

---

## üìä Estado del Proyecto

- ‚úÖ MVP Completo
- ‚úÖ En Producci√≥n: [speaklyplan.abacusai.app](https://speaklyplan.abacusai.app)
- ‚úÖ Tests: Pendiente de implementaci√≥n
- ‚úÖ Documentaci√≥n: Completa
- ‚úÖ CI/CD: Pendiente de configuraci√≥n

---

**√öltima actualizaci√≥n:** 20 de octubre de 2025  
**Versi√≥n:** 1.0.0
